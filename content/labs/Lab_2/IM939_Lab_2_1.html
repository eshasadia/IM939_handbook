<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Lab: Pandas – Data Science Across Disciplines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../content/labs/Lab_2/IM939_Lab_2_2.html" rel="next">
<link href="../../../content/sessions/session-02.html" rel="prev">
<link href="../../../media/CIM_logo.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta name="twitter:title" content="6&nbsp; Lab: Pandas – Data Science Across Disciplines">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://warwickcim.github.io/IM939_handbook/content/labs/Lab_2/media/IM939_logo.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../content/sessions/session-02.html">Thinking Data: Theoretical and Practical Concerns</a></li><li class="breadcrumb-item"><a href="../../../content/labs/Lab_2/IM939_Lab_2_1.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab: Pandas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../media/IM939_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">Data Science Across Disciplines</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/WarwickCIM/IM939_handbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">About</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/about/teaching_staff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching Staff</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/about/im939.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the module</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/about/teaching_materials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teaching materials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/about/conventions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book Conventions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Introduction and Historical Perspectives</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_1/IM939_Lab_1_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab: Introduction to Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_1/IM939_Lab_1_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab: Repetition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_1/IM939_Lab_1_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lab: Libraries</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Thinking Data: Theoretical and Practical Concerns</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_2/IM939_Lab_2_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab: Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_2/IM939_Lab_2_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Lab: Visualising Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_2/IM939_Lab_2_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lab: Missing data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_2/IM939_Lab_2_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab: Seaborn</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Abstractions &amp; Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_3/IM939_Lab_3_1_Data_Processing_and_Summarization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Lab: Data Processing and Summarization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_3/IM939_Lab_3_2_Linear_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Lab: Regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_3/IM939_Lab_3_Exercise_Linear_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exercise: Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Structures &amp; Spaces</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_4/IM939_Session-04_PCA_playground.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with Dimension Reduction Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_4/IM939_Lab_4_1_Iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Lab: Dimension Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_4/IM939_Lab_4_2_Crime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Lab: Dimension reduction (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_4/IM939_Lab_4_Exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Exercise: Wine dataset</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Multi-model thinking and rigour</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_5/week5_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Recap</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_5/IM939_Lab_5_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Lab: Working with multiple models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_5/IM939_Lab_5_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Lab: Clustering and Ground Truth</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_5/IM939_Lab_5_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lab: Cross validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_5/IM939_lab_5_Exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">IM939 lab 5 - Exercise</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Recognising and avoiding traps</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_6/IM939_Lab_6_1-illusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Lab: Illusions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_6/IM939_Lab_6_2-AxisManipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Lab: Axes manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_6/IM939_Lab_6_3-Choropleths.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lab: Choropleth Maps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_6/IM939_Lab_6_4-Exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Exercise: Data visualisation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_6/IM939_Lab_6_5-Simpsons_Paradox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">IM939 - Lab 6 Part 5 Simpson’s Paradox</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Data Science &amp; Society</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_7/IM939_Lab7-Part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Lab: Hate crimes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_7/IM939_Lab7-Part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Lab: Poverty and Inequality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/Lab_7/IM939_Lab7-Part3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Lab: Gender gaps</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Data Science Workshop</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Session 1: Design Thinking in Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-08_WorkshopBrief.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Brief: Analysing Health Indicators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/sessions/session-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Session 2: Bring Your Own Data (BYOD)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/labs/labs_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Setting up your machine</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../content/files-and-folders.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Working with files and directories</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link active" data-scroll-target="#dataset"><span class="header-section-number">6.1</span> Dataset</a></li>
  <li><a href="#starting" id="toc-starting" class="nav-link" data-scroll-target="#starting"><span class="header-section-number">6.2</span> Starting</a></li>
  <li><a href="#help" id="toc-help" class="nav-link" data-scroll-target="#help"><span class="header-section-number">6.3</span> Help!</a></li>
  <li><a href="#structure" id="toc-structure" class="nav-link" data-scroll-target="#structure"><span class="header-section-number">6.4</span> Structure</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">6.5</span> Summary</a></li>
  <li><a href="#subsetting" id="toc-subsetting" class="nav-link" data-scroll-target="#subsetting"><span class="header-section-number">6.6</span> Subsetting</a>
  <ul class="collapse">
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link" data-scroll-target="#selecting-columns"><span class="header-section-number">6.6.1</span> Selecting columns</a></li>
  <li><a href="#filtering-rows" id="toc-filtering-rows" class="nav-link" data-scroll-target="#filtering-rows"><span class="header-section-number">6.6.2</span> Filtering rows</a></li>
  </ul></li>
  <li><a href="#adding-columns" id="toc-adding-columns" class="nav-link" data-scroll-target="#adding-columns"><span class="header-section-number">6.7</span> Adding columns</a></li>
  <li><a href="#writing-data" id="toc-writing-data" class="nav-link" data-scroll-target="#writing-data"><span class="header-section-number">6.8</span> Writing data</a></li>
  <li><a href="#combining-datasets" id="toc-combining-datasets" class="nav-link" data-scroll-target="#combining-datasets"><span class="header-section-number">6.9</span> Combining datasets</a>
  <ul class="collapse">
  <li><a href="#well-done" id="toc-well-done" class="nav-link" data-scroll-target="#well-done"><span class="header-section-number">6.9.1</span> Well done!</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/WarwickCIM/IM939_handbook/blob/main/content/labs/Lab_2/IM939_Lab_2_1.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/WarwickCIM/IM939_handbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../content/sessions/session-02.html">Thinking Data: Theoretical and Practical Concerns</a></li><li class="breadcrumb-item"><a href="../../../content/labs/Lab_2/IM939_Lab_2_1.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab: Pandas</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab: Pandas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Last week we loaded data using <a href="https://pandas.pydata.org/"><code>pandas</code></a>’ <code>read.csv()</code> method, but Pandas can do way more than that. Pandas is an essential library for data science, as it provides the data structures (nameley, <code>series</code> -1D- and <code>data frames</code> -2D) and operations for manipulating tabular data.</p>
<p>In this unit’s labs we will be using <code>pandas</code> to read in, process and explore data (this notebook); create (basic) visualisations capabilities (<a href="IM939_Lab_2_2.html" class="quarto-xref"><span>Chapter 7</span></a>) as well as transforming data (<a href="IM939_Lab_2_3.html" class="quarto-xref"><span>Chapter 8</span></a>). To do so, we will be using a dataset about <em>“The Office”</em>.</p>
<section id="dataset" class="level2 page-columns page-full" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="dataset"><span class="header-section-number">6.1</span> Dataset</h2>
<p><a href="https://www.imdb.com/title/tt0386676/?ref_=ttep_ov"><em>The Office</em></a> is a humoristic TV series originally created in 2001 by Ricky Gervais and Stephen Merchant that has received several adaptations. The dataset that we will be using contains information (i.e., title, date and ratings from <a href="https://www.imdb.com/title/tt0386676/?ref_=ttep_ov">IMBDB</a>) about every episode of the 9 seaons of the very successful USA’s adaptation aired between 2005 and 2013.</p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/the_office.png" class="img-fluid figure-img" width="400"></p>
<figcaption><em>The Office</em> promotional poster</figcaption>
</figure>
</div>
</div></div><p>The dataset is stored in a <code>csv</code> file that has the following columns: <code>season</code>, <code>episode</code>, <code>title</code>, <code>imdb_rating</code>, <code>total_votes</code>, <code>air_date</code>.</p>
</section>
<section id="starting" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="starting"><span class="header-section-number">6.2</span> Starting</h2>
<p>To work with the dataset we will need to <em>import</em> pandas so we can use every feature provided by the library, as well as loading the dataset stored in the <code>office_ratings.csv</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These two lines are added so that not all the warnings are rendered in the cell. </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We do this not to confuse you during your learning journey with some of the warnings but </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># normally you would want them turned on since they can tell you something about things that might not be working as expected.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this following import will always be needed whenever you want to work with Pandas.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/raw/office_ratings.csv'</span>, encoding<span class="op">=</span><span class="st">'UTF-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 188 entries, 0 to 187
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   season       188 non-null    int64  
 1   episode      188 non-null    int64  
 2   title        188 non-null    object 
 3   imdb_rating  188 non-null    float64
 4   total_votes  188 non-null    int64  
 5   air_date     188 non-null    object 
dtypes: float64(1), int64(3), object(2)
memory usage: 8.9+ KB</code></pre>
</div>
</div>
</section>
<section id="help" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="help"><span class="header-section-number">6.3</span> Help!</h2>
<p>Python has inbuilt documentation. To access this add a <code>?</code> before an object or method.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The output of the help function has been omitted in the handbook. Please run the cells in your notebook to read the different outputs</p>
</div>
</div>
<p>For example, our dataframe</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>?df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or the <code>dtypes</code> property</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Properties of object are values associated with the object and are not called with a <code>()</code> at the end.</p>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>?df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>info</code> method for dataframes.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>?df.info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you would like to get help in-line like the examples above, that can give a very long help message that might not be always convenient. If you like, you can try to get the help for this following function like this:</p>
<blockquote class="blockquote">
<p>?pd.read_csv</p>
</blockquote>
<p>However, the below will be quite long – it provides you the various arguments (options) you can use with the method.</p>
<p>Instead of this approach, a much better way to get help is to refer to the documentation and the API of the library that you are using. For instance, for <code>read_csv()</code>, this page is much more useful – https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html</p>
<p>We recommend that you use a search engine very frequently.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>?pd.read_csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Pandas documentation is rather good. Relevent to our below work is:</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/01_table_oriented.html#min-tut-01-tableoriented">What kind of data does pandas handle?</a></li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/01_table_oriented.html#min-tut-01-tableoriented">How to calculate summary statistics?</a></li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/04_plotting.html#min-tut-04-plotting">How to create plots in pandas?</a></li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/09_timeseries.html#min-tut-09-timeseries">How to handle time series data with ease?</a></li>
</ul>
<p>I also found <a href="https://bitbucket.org/hrojas/learn-pandas/src/master/">a rather nice series of lessons a kind person put together</a>. There are lots of online tutorials which will help you.</p>
</section>
<section id="structure" class="level2 page-columns page-full" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="structure"><span class="header-section-number">6.4</span> Structure</h2>
<p>In <a href="../Lab_1/IM939_Lab_1_1.html#sec-data-types" class="quarto-xref"><span>Section 2.3</span></a> we introduced Python’s data types as well as how to use the function <code>type()</code> to retrieve an object’s data type. Pandas expands python’s data types by creating a new one called <code>data frame</code></p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Do you remember what are Python’s data types? You can refer to <a href="../Lab_1/IM939_Lab_1_1.html#sec-data-types" class="quarto-xref"><span>Section 2.3</span></a> for a refresher and to know more about them.</p>
</div></div><div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data frames
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data frames are 2-dimensional data structures that store information in columns and rows, very much like data is stored in a spreadsheet or a database. Typically, every column will contain variables (or sometimes called attributes) whereas every row represents an observation. This is known as wide data frames, as opposed to long data frames.</p>
<p>In pandas, every column has a name and rows can be named, too.</p>
</div>
</div>
<p>So let’s check the what our newly created object’s (<code>df</code>) data type:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p>Unsurprisingly, <code>df</code> is a `DataFrame`` object, provided by pandas.</p>
<p>The <code>DataFrame</code> object has lots of built in <em>methods</em> and <em>attributes</em>.</p>
<p>The <code>info</code> method gives us information about datatypes, dimensions and the presence of null values in our dataframe. Let’s see how can we use it and what information is returned:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 188 entries, 0 to 187
Data columns (total 6 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   season       188 non-null    int64  
 1   episode      188 non-null    int64  
 2   title        188 non-null    object 
 3   imdb_rating  188 non-null    float64
 4   total_votes  188 non-null    int64  
 5   air_date     188 non-null    object 
dtypes: float64(1), int64(3), object(2)
memory usage: 8.9+ KB</code></pre>
</div>
</div>
<p>We can just <code>dtypes</code> to check the data types of every variable in the data frame.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>season           int64
episode          int64
title           object
imdb_rating    float64
total_votes      int64
air_date        object
dtype: object</code></pre>
</div>
</div>
<p>Or just the dimensions (e.g., rows and columns).</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(188, 6)</code></pre>
</div>
</div>
<p>In this case, there are only 188 rows. But for larger datasets we might want to look at the head (top 5) and tail (bottom 5) rows using <code>.head()</code> and <code>.tail()</code>, respectively.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>Pilot</td>
<td>7.6</td>
<td>3706</td>
<td>2005-03-24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>Diversity Day</td>
<td>8.3</td>
<td>3566</td>
<td>2005-03-29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>Health Care</td>
<td>7.9</td>
<td>2983</td>
<td>2005-04-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>The Alliance</td>
<td>8.1</td>
<td>2886</td>
<td>2005-04-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>Basketball</td>
<td>8.4</td>
<td>3179</td>
<td>2005-04-19</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>9</td>
<td>19</td>
<td>Stairmageddon</td>
<td>8.0</td>
<td>1484</td>
<td>2013-04-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>9</td>
<td>20</td>
<td>Paper Airplane</td>
<td>8.0</td>
<td>1482</td>
<td>2013-04-25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>9</td>
<td>21</td>
<td>Livin' the Dream</td>
<td>8.9</td>
<td>2041</td>
<td>2013-05-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9</td>
<td>22</td>
<td>A.A.R.M.</td>
<td>9.3</td>
<td>2860</td>
<td>2013-05-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>9</td>
<td>23</td>
<td>Finale</td>
<td>9.7</td>
<td>7934</td>
<td>2013-05-16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="summary"><span class="header-section-number">6.5</span> Summary</h2>
<p>To get an overview of our data we can ask Python to ‘<em>describe</em> our (numeric) data’</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>188.000000</td>
<td>188.000000</td>
<td>188.000000</td>
<td>188.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.468085</td>
<td>11.877660</td>
<td>8.257447</td>
<td>2126.648936</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.386245</td>
<td>7.024855</td>
<td>0.538067</td>
<td>787.098275</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>1.000000</td>
<td>6.700000</td>
<td>1393.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>3.000000</td>
<td>6.000000</td>
<td>7.900000</td>
<td>1631.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>6.000000</td>
<td>11.500000</td>
<td>8.200000</td>
<td>1952.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>7.250000</td>
<td>18.000000</td>
<td>8.600000</td>
<td>2379.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>9.000000</td>
<td>26.000000</td>
<td>9.700000</td>
<td>7934.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>or we can pull out specific statistics for numeric columns.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: Could not convert ["PilotDiversity DayHealth CareThe AllianceBasketballHot GirlThe DundiesSexual HarassmentOffice OlympicsThe FireHalloweenThe FightThe ClientPerformance ReviewE-Mail SurveillanceChristmas PartyBooze CruiseThe InjuryThe SecretThe CarpetBoys and GirlsValentine's DayDwight's SpeechTake Your Daughter to Work DayMichael's BirthdayDrug TestingConflict ResolutionCasino NightGay Witch HuntThe ConventionThe CoupGrief CounselingInitiationDiwaliBranch ClosingThe MergerThe ConvictA Benihana ChristmasBack from VacationTraveling SalesmenThe ReturnBen FranklinPhyllis' WeddingBusiness SchoolCocktailsThe NegotiationSafety TrainingProduct RecallWomen's AppreciationBeach GamesThe JobFun RunDunder Mifflin InfinityLaunch PartyMoneyLocal AdBranch WarsSurvivor ManThe DepositionDinner PartyChair ModelNight OutDid I Stutter?Job FairGoodbye, TobyWeight LossBusiness EthicsBaby ShowerCrime AidEmployee TransferCustomer SurveyBusiness TripFrame TobyThe SurplusMoroccan ChristmasThe DuelPrince Family PaperStress ReliefLecture Circuit: Part 1Lecture Circuit: Part 2Blood DriveGolden TicketNew BossTwo WeeksDream TeamMichael Scott Paper CompanyHeavy CompetitionBrokeCasual FridayCafe DiscoCompany PicnicGossipThe MeetingThe PromotionNiagara: Part 1Niagara: Part 2MafiaThe LoverKoi PondDouble DateMurderShareholder MeetingScott's TotsSecret SantaThe BankerSabreManager and SalesmanThe Delivery: Part 1The Delivery: Part 2St. Patrick's DayNew LeadsHappy HourSecretary's DayBody LanguageThe Cover-UpThe ChumpWhistleblowerNepotismCounselingAndy's PlaySex EdThe StingCostume ContestChristeningViewing PartyWUPHF.comChinaClassy ChristmasUltimatumThe SeminarThe SearchPDAThreat Level MidnightTodd PackerGarage SaleTraining DayMichael's Last DundiesGoodbye, MichaelThe Inner CircleDwight K. Schrute, (Acting) ManagerSearch CommitteeThe ListThe IncentiveLottoGarden PartySpookedDoomsdayPam's ReplacementGettysburgMrs. CaliforniaChristmas WishesTriviaPool PartyJury DutySpecial ProjectTallahasseeAfter HoursTest the StoreLast Day in FloridaGet the GirlWelcome PartyAngry AndyFundraiserTurf WarFree Family Portrait StudioNew GuysRoy's WeddingAndy's AncestryWork BusHere Comes TrebleThe BoatThe WhaleThe TargetDwight ChristmasLiceSuit WarehouseCustomer LoyaltyJunior SalesmanVandalismCouples DiscountMoving OnThe FarmPromosStairmageddonPaper AirplaneLivin' the DreamA.A.R.M.Finale"
 '2005-03-242005-03-292005-04-052005-04-122005-04-192005-04-262005-09-202005-09-272005-10-042005-10-112005-10-182005-11-012005-11-082005-11-152005-11-222005-12-062006-01-052006-01-122006-01-192006-01-262006-02-022006-02-092006-03-022006-03-162006-03-302006-04-272006-05-042006-05-112006-09-212006-09-282006-10-052006-10-122006-10-192006-11-022006-11-092006-11-162006-11-302006-12-142007-01-042007-01-112007-01-182007-02-012007-02-082007-02-152007-02-222007-04-052007-04-122007-04-262007-05-032007-05-102007-05-172007-09-272007-10-042007-10-112007-10-182007-10-252007-11-012007-11-082007-11-152008-04-102008-04-172008-04-242008-05-012008-05-082008-05-152008-09-252008-10-092008-10-162008-10-232008-10-302008-11-062008-11-132008-11-202008-12-042008-12-112009-01-152009-01-222009-02-012009-02-052009-02-122009-03-052009-03-122009-03-192009-03-262009-04-092009-04-092009-04-162009-04-232009-04-302009-05-072009-05-142009-09-172009-09-242009-10-012009-10-082009-10-082009-10-152009-10-222009-10-292009-11-052009-11-122009-11-192009-12-032009-12-102010-01-212010-02-042010-02-112010-03-042010-03-042010-03-112010-03-182010-03-252010-04-222010-04-292010-05-062010-05-132010-05-202010-09-232010-09-302010-10-072010-10-142010-10-212010-10-282010-11-042010-11-112010-11-182010-12-022010-12-092011-01-202011-01-272011-02-032011-02-102011-02-172011-02-242011-03-242011-04-142011-04-212011-04-282011-05-052011-05-122011-05-192011-09-222011-09-292011-10-062011-10-132011-10-272011-11-032011-11-102011-11-172011-12-012011-12-082012-01-122012-01-192012-02-022012-02-092012-02-162012-02-232012-03-012012-03-082012-03-152012-04-122012-04-192012-04-262012-05-032012-05-102012-09-202012-09-272012-10-042012-10-182012-10-252012-11-082012-11-152012-11-292012-12-062013-01-102013-01-172013-01-242013-01-312013-01-312013-02-072013-02-142013-03-142013-04-042013-04-112013-04-252013-05-022013-05-092013-05-16'] to numeric</code></pre>
</div>
</div>
<p>Note the error triggered above due to pandas attempting to calculate the mean of the wrong type (i.e.&nbsp;non-numeric values). We can address that by only computing the mean of numeric values (see below):</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>season            5.468085
episode          11.877660
imdb_rating       8.257447
total_votes    2126.648936
dtype: float64</code></pre>
</div>
</div>
<p>or the sum of every value within the same column:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>season                                                      1028
episode                                                     2233
title          PilotDiversity DayHealth CareThe AllianceBaske...
imdb_rating                                               1552.4
total_votes                                               399810
air_date       2005-03-242005-03-292005-04-052005-04-122005-0...
dtype: object</code></pre>
</div>
</div>
<p>Similarly to what happened with <code>mean()</code>, <code>sum()</code> is adding all values in every observation of every attribute, regardless of their type, but this time is not producing an error. Can you see what happens with strings? And with dates?</p>
<p>Again, we can force to use numeric values only:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>season           1028.0
episode          2233.0
imdb_rating      1552.4
total_votes    399810.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="subsetting" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="subsetting"><span class="header-section-number">6.6</span> Subsetting</h2>
<p>Often times we may have a large dataset and we only need to work with just a part of it (a subset) consisting of certain columns and/or rows. Selecting specific columns and/or rows is known as subsetting.</p>
<section id="selecting-columns" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="selecting-columns"><span class="header-section-number">6.6.1</span> Selecting columns</h3>
<p>Because in pandas every column has a name, we can select columns by their name or their position.</p>
<section id="selecting-by-name" class="level4" data-number="6.6.1.1">
<h4 data-number="6.6.1.1" class="anchored" data-anchor-id="selecting-by-name"><span class="header-section-number">6.6.1.1</span> Selecting by name</h4>
<p>To select by name we will use the syntax <code>df['&lt;column_name&gt;']</code>. For example, if we wanted to select the ratings:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'imdb_rating'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0      7.6
1      8.3
2      7.9
3      8.1
4      8.4
      ... 
183    8.0
184    8.0
185    8.9
186    9.3
187    9.7
Name: imdb_rating, Length: 188, dtype: float64</code></pre>
</div>
</div>
<p>or we could select the date in which the chapters were first aired:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'air_date'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>0      2005-03-24
1      2005-03-29
2      2005-04-05
3      2005-04-12
4      2005-04-19
          ...    
183    2013-04-11
184    2013-04-25
185    2013-05-02
186    2013-05-09
187    2013-05-16
Name: air_date, Length: 188, dtype: object</code></pre>
</div>
</div>
<p>We can even select more than one column!</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'imdb_rating'</span>, <span class="st">'total_votes'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>7.6</td>
<td>3706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8.3</td>
<td>3566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7.9</td>
<td>2983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8.1</td>
<td>2886</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8.4</td>
<td>3179</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>8.0</td>
<td>1484</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>8.0</td>
<td>1482</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>8.9</td>
<td>2041</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9.3</td>
<td>2860</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>9.7</td>
<td>7934</td>
</tr>
</tbody>
</table>

<p>188 rows × 2 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Did you notice that we used two sets of squared brackets (<code>[[]]</code>)? This is needed because we need to passing a <em>list</em> of the column names to the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#basics"><code>__getitem__</code></a> method of the pandas dataframe object, and as you may remember from <a href="../Lab_1/IM939_Lab_1_1.html#sec-list-dictionaries" class="quarto-xref"><span>Section 2.3.2</span></a>, this is the syntax used for lists (thank <a href="https://stackoverflow.com/questions/11285613/selecting-multiple-columns-in-a-pandas-dataframe">this stackoverflow question</a>).</p>
<p>This is what we’d get otherwise:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'imdb_rating'</span>, <span class="st">'total_votes'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: ('imdb_rating', 'total_votes')</code></pre>
</div>
</div>
<p>You can also check out the pandas documentation on <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#basics">indexing and selecting data</a>.</p>
</div>
</div>
<p>We can also apply methods to subset, such as this one to get the average rating:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'imdb_rating'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>8.25744680851064</code></pre>
</div>
</div>
<p>Or to calculate the total number of votes:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'total_votes'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>399810</code></pre>
</div>
</div>
<p>Or a combination of multiple columns:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'imdb_rating'</span>, <span class="st">'total_votes'</span>]].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>imdb_rating       8.257447
total_votes    2126.648936
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="selecting-by-position" class="level4" data-number="6.6.1.2">
<h4 data-number="6.6.1.2" class="anchored" data-anchor-id="selecting-by-position"><span class="header-section-number">6.6.1.2</span> Selecting by position</h4>
<p>If we do not want to use column names, we can use <code>iloc</code> method by using the syntax <code>&lt;object&gt;.iloc[&lt;row slice&gt;, &lt;column slice&gt;]</code>, where a slice is a range of numbers separated by a colon <code>:</code>. So, if we were to select the value in the 4th row and 2nd column, we’d use:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">4</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>'Basketball'</code></pre>
</div>
</div>
<p>But if we just wanted to select a column? In that case, we can use the same method but instead of specifiying a row, we will need to use <code>:</code> to indicate that we are selecting all the rows, such as:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df.iloc[:,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0                 Pilot
1         Diversity Day
2           Health Care
3          The Alliance
4            Basketball
             ...       
183       Stairmageddon
184      Paper Airplane
185    Livin' the Dream
186            A.A.R.M.
187              Finale
Name: title, Length: 188, dtype: object</code></pre>
</div>
</div>
<p>Conversely, if we just wanted to select all the columns from a given row, we’d use <code>:</code> on the right side of the <code>,</code> like this:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">4</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>season                  1
episode                 5
title          Basketball
imdb_rating           8.4
total_votes          3179
air_date       2005-04-19
Name: 4, dtype: object</code></pre>
</div>
</div>
<p>We can use negative values in indexes to indicate ‘from the end’. So, an index of [-10, :] returns the 10th from last row.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="op">-</span><span class="dv">10</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>season                  9
episode                14
title           Vandalism
imdb_rating           7.6
total_votes          1402
air_date       2013-01-31
Name: 178, dtype: object</code></pre>
</div>
</div>
<p>Instead of using tail, we could ask for the last 5 rows with an index of <code>[-5:, :]</code>. I read <code>:</code> as ‘and everything else’ in these cases.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="op">-</span><span class="dv">5</span>:,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>9</td>
<td>19</td>
<td>Stairmageddon</td>
<td>8.0</td>
<td>1484</td>
<td>2013-04-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>9</td>
<td>20</td>
<td>Paper Airplane</td>
<td>8.0</td>
<td>1482</td>
<td>2013-04-25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>9</td>
<td>21</td>
<td>Livin' the Dream</td>
<td>8.9</td>
<td>2041</td>
<td>2013-05-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9</td>
<td>22</td>
<td>A.A.R.M.</td>
<td>9.3</td>
<td>2860</td>
<td>2013-05-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>9</td>
<td>23</td>
<td>Finale</td>
<td>9.7</td>
<td>7934</td>
<td>2013-05-16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>9</td>
<td>19</td>
<td>Stairmageddon</td>
<td>8.0</td>
<td>1484</td>
<td>2013-04-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>9</td>
<td>20</td>
<td>Paper Airplane</td>
<td>8.0</td>
<td>1482</td>
<td>2013-04-25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>9</td>
<td>21</td>
<td>Livin' the Dream</td>
<td>8.9</td>
<td>2041</td>
<td>2013-05-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9</td>
<td>22</td>
<td>A.A.R.M.</td>
<td>9.3</td>
<td>2860</td>
<td>2013-05-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>9</td>
<td>23</td>
<td>Finale</td>
<td>9.7</td>
<td>7934</td>
<td>2013-05-16</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the row is shown on the left. That will stop you getting lost in slices of the data.</p>
<p>For the top ten rows</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">10</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>Pilot</td>
<td>7.6</td>
<td>3706</td>
<td>2005-03-24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>Diversity Day</td>
<td>8.3</td>
<td>3566</td>
<td>2005-03-29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>Health Care</td>
<td>7.9</td>
<td>2983</td>
<td>2005-04-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>The Alliance</td>
<td>8.1</td>
<td>2886</td>
<td>2005-04-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>Basketball</td>
<td>8.4</td>
<td>3179</td>
<td>2005-04-19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>6</td>
<td>Hot Girl</td>
<td>7.8</td>
<td>2852</td>
<td>2005-04-26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2</td>
<td>1</td>
<td>The Dundies</td>
<td>8.7</td>
<td>3213</td>
<td>2005-09-20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2</td>
<td>2</td>
<td>Sexual Harassment</td>
<td>8.2</td>
<td>2736</td>
<td>2005-09-27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2</td>
<td>3</td>
<td>Office Olympics</td>
<td>8.4</td>
<td>2742</td>
<td>2005-10-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2</td>
<td>4</td>
<td>The Fire</td>
<td>8.4</td>
<td>2713</td>
<td>2005-10-11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Of course, we can run methods on these slices. We could, if we wanted to, calculate the mean imdb rating of only the first and last 100 episodes. <em>Note</em> the indexing starts at 0 so we want the column index of 3 (0:season, 1:episode, 2:title, 3:imdb_rating).</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">100</span>,<span class="dv">3</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>8.483</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="op">-</span><span class="dv">100</span>:,<span class="dv">3</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>8.062</code></pre>
</div>
</div>
<p>If you are unsure how many rows you have then the count method comes to the rescue.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="op">-</span><span class="dv">100</span>:,<span class="dv">3</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>100</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>188.000000</td>
<td>188.000000</td>
<td>188.000000</td>
<td>188.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.468085</td>
<td>11.877660</td>
<td>8.257447</td>
<td>2126.648936</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.386245</td>
<td>7.024855</td>
<td>0.538067</td>
<td>787.098275</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>1.000000</td>
<td>6.700000</td>
<td>1393.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>3.000000</td>
<td>6.000000</td>
<td>7.900000</td>
<td>1631.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>6.000000</td>
<td>11.500000</td>
<td>8.200000</td>
<td>1952.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>7.250000</td>
<td>18.000000</td>
<td>8.600000</td>
<td>2379.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>9.000000</td>
<td>26.000000</td>
<td>9.700000</td>
<td>7934.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>So it looks like the last 100 episodes were less good than the first 100. I guess that is why it was cancelled.</p>
<p>Our data is organised by season. Looking at the average by season might help.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'season'</span>, <span class="st">'imdb_rating'</span>]].groupby(<span class="st">'season'</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>8.016667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>8.436364</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>8.573913</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>8.600000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>8.492308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>8.219231</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>8.316667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>7.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>7.956522</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The above line groups our dataframe by values in the season column and then displays the mean for each group. Pretty nifty.</p>
<p>Season 8 looks pretty bad. We can look at just the rows for season 8.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">'season'</span>] <span class="op">==</span> <span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">141</td>
<td>8</td>
<td>1</td>
<td>The List</td>
<td>8.2</td>
<td>1829</td>
<td>2011-09-22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">142</td>
<td>8</td>
<td>2</td>
<td>The Incentive</td>
<td>8.2</td>
<td>1668</td>
<td>2011-09-29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">143</td>
<td>8</td>
<td>3</td>
<td>Lotto</td>
<td>7.3</td>
<td>1601</td>
<td>2011-10-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">144</td>
<td>8</td>
<td>4</td>
<td>Garden Party</td>
<td>8.1</td>
<td>1717</td>
<td>2011-10-13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145</td>
<td>8</td>
<td>5</td>
<td>Spooked</td>
<td>7.6</td>
<td>1543</td>
<td>2011-10-27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>8</td>
<td>6</td>
<td>Doomsday</td>
<td>7.8</td>
<td>1476</td>
<td>2011-11-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">147</td>
<td>8</td>
<td>7</td>
<td>Pam's Replacement</td>
<td>7.7</td>
<td>1563</td>
<td>2011-11-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">148</td>
<td>8</td>
<td>8</td>
<td>Gettysburg</td>
<td>7.0</td>
<td>1584</td>
<td>2011-11-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">149</td>
<td>8</td>
<td>9</td>
<td>Mrs. California</td>
<td>7.7</td>
<td>1553</td>
<td>2011-12-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150</td>
<td>8</td>
<td>10</td>
<td>Christmas Wishes</td>
<td>8.0</td>
<td>1547</td>
<td>2011-12-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">151</td>
<td>8</td>
<td>11</td>
<td>Trivia</td>
<td>7.9</td>
<td>1488</td>
<td>2012-01-12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">152</td>
<td>8</td>
<td>12</td>
<td>Pool Party</td>
<td>8.0</td>
<td>1612</td>
<td>2012-01-19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">153</td>
<td>8</td>
<td>13</td>
<td>Jury Duty</td>
<td>7.5</td>
<td>1478</td>
<td>2012-02-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">154</td>
<td>8</td>
<td>14</td>
<td>Special Project</td>
<td>7.8</td>
<td>1432</td>
<td>2012-02-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">155</td>
<td>8</td>
<td>15</td>
<td>Tallahassee</td>
<td>7.9</td>
<td>1522</td>
<td>2012-02-16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">156</td>
<td>8</td>
<td>16</td>
<td>After Hours</td>
<td>8.1</td>
<td>1567</td>
<td>2012-02-23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157</td>
<td>8</td>
<td>17</td>
<td>Test the Store</td>
<td>7.8</td>
<td>1478</td>
<td>2012-03-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">158</td>
<td>8</td>
<td>18</td>
<td>Last Day in Florida</td>
<td>7.8</td>
<td>1429</td>
<td>2012-03-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">159</td>
<td>8</td>
<td>19</td>
<td>Get the Girl</td>
<td>6.7</td>
<td>1642</td>
<td>2012-03-15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">160</td>
<td>8</td>
<td>20</td>
<td>Welcome Party</td>
<td>7.2</td>
<td>1489</td>
<td>2012-04-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">161</td>
<td>8</td>
<td>21</td>
<td>Angry Andy</td>
<td>7.1</td>
<td>1585</td>
<td>2012-04-19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">162</td>
<td>8</td>
<td>22</td>
<td>Fundraiser</td>
<td>7.1</td>
<td>1453</td>
<td>2012-04-26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">163</td>
<td>8</td>
<td>23</td>
<td>Turf War</td>
<td>7.7</td>
<td>1393</td>
<td>2012-05-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">164</td>
<td>8</td>
<td>24</td>
<td>Free Family Portrait Studio</td>
<td>7.8</td>
<td>1464</td>
<td>2012-05-10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="filtering-rows" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="filtering-rows"><span class="header-section-number">6.6.2</span> Filtering rows</h3>
<p>We can filter rows matching some criteria by using the syntax <code>&lt;object&gt;.loc[&lt;criteria&gt;]</code>. So, if we wanted to filter all the episodes from the 8th season, we would do the following:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">'season'</span>] <span class="op">==</span> <span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">141</td>
<td>8</td>
<td>1</td>
<td>The List</td>
<td>8.2</td>
<td>1829</td>
<td>2011-09-22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">142</td>
<td>8</td>
<td>2</td>
<td>The Incentive</td>
<td>8.2</td>
<td>1668</td>
<td>2011-09-29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">143</td>
<td>8</td>
<td>3</td>
<td>Lotto</td>
<td>7.3</td>
<td>1601</td>
<td>2011-10-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">144</td>
<td>8</td>
<td>4</td>
<td>Garden Party</td>
<td>8.1</td>
<td>1717</td>
<td>2011-10-13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145</td>
<td>8</td>
<td>5</td>
<td>Spooked</td>
<td>7.6</td>
<td>1543</td>
<td>2011-10-27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>8</td>
<td>6</td>
<td>Doomsday</td>
<td>7.8</td>
<td>1476</td>
<td>2011-11-03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">147</td>
<td>8</td>
<td>7</td>
<td>Pam's Replacement</td>
<td>7.7</td>
<td>1563</td>
<td>2011-11-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">148</td>
<td>8</td>
<td>8</td>
<td>Gettysburg</td>
<td>7.0</td>
<td>1584</td>
<td>2011-11-17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">149</td>
<td>8</td>
<td>9</td>
<td>Mrs. California</td>
<td>7.7</td>
<td>1553</td>
<td>2011-12-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150</td>
<td>8</td>
<td>10</td>
<td>Christmas Wishes</td>
<td>8.0</td>
<td>1547</td>
<td>2011-12-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">151</td>
<td>8</td>
<td>11</td>
<td>Trivia</td>
<td>7.9</td>
<td>1488</td>
<td>2012-01-12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">152</td>
<td>8</td>
<td>12</td>
<td>Pool Party</td>
<td>8.0</td>
<td>1612</td>
<td>2012-01-19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">153</td>
<td>8</td>
<td>13</td>
<td>Jury Duty</td>
<td>7.5</td>
<td>1478</td>
<td>2012-02-02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">154</td>
<td>8</td>
<td>14</td>
<td>Special Project</td>
<td>7.8</td>
<td>1432</td>
<td>2012-02-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">155</td>
<td>8</td>
<td>15</td>
<td>Tallahassee</td>
<td>7.9</td>
<td>1522</td>
<td>2012-02-16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">156</td>
<td>8</td>
<td>16</td>
<td>After Hours</td>
<td>8.1</td>
<td>1567</td>
<td>2012-02-23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">157</td>
<td>8</td>
<td>17</td>
<td>Test the Store</td>
<td>7.8</td>
<td>1478</td>
<td>2012-03-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">158</td>
<td>8</td>
<td>18</td>
<td>Last Day in Florida</td>
<td>7.8</td>
<td>1429</td>
<td>2012-03-08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">159</td>
<td>8</td>
<td>19</td>
<td>Get the Girl</td>
<td>6.7</td>
<td>1642</td>
<td>2012-03-15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">160</td>
<td>8</td>
<td>20</td>
<td>Welcome Party</td>
<td>7.2</td>
<td>1489</td>
<td>2012-04-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">161</td>
<td>8</td>
<td>21</td>
<td>Angry Andy</td>
<td>7.1</td>
<td>1585</td>
<td>2012-04-19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">162</td>
<td>8</td>
<td>22</td>
<td>Fundraiser</td>
<td>7.1</td>
<td>1453</td>
<td>2012-04-26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">163</td>
<td>8</td>
<td>23</td>
<td>Turf War</td>
<td>7.7</td>
<td>1393</td>
<td>2012-05-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">164</td>
<td>8</td>
<td>24</td>
<td>Free Family Portrait Studio</td>
<td>7.8</td>
<td>1464</td>
<td>2012-05-10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding the criteria
</div>
</div>
<div class="callout-body-container callout-body">
<p>To understand why we have to write the name of the dataframe twice, we can focus on the output provided by the filtering criteria only:</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'season'</span>] <span class="op">==</span> <span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0      False
1      False
2      False
3      False
4      False
       ...  
183     True
184     True
185     True
186     True
187     True
Name: season, Length: 188, dtype: bool</code></pre>
</div>
</div>
<p>As you can see, it returns a boolean serie specifiying which rows are matching the criteria (<code>True</code>) and which ones are not (<code>False</code>)</p>
<p>As a side note, while writing the name of the dataframe twice may seem redundant, this means that we could filter rows based on other objects.</p>
</div>
</div>
<p>We can get an overview of the rating of all chapters within season 8 by:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">'season'</span>] <span class="op">==</span> <span class="dv">8</span>, <span class="st">'imdb_rating'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>count    24.000000
mean      7.666667
std       0.405041
min       6.700000
25%       7.450000
50%       7.800000
75%       7.925000
max       8.200000
Name: imdb_rating, dtype: float64</code></pre>
</div>
</div>
<p>Generally pretty bad, but there is clearly one very disliked episode.</p>
</section>
</section>
<section id="adding-columns" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="adding-columns"><span class="header-section-number">6.7</span> Adding columns</h2>
<p>We can add new columns pretty simply.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'x'</span>] <span class="op">=</span> <span class="dv">44</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
<th data-quarto-table-cell-role="th">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>Pilot</td>
<td>7.6</td>
<td>3706</td>
<td>2005-03-24</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>Diversity Day</td>
<td>8.3</td>
<td>3566</td>
<td>2005-03-29</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>Health Care</td>
<td>7.9</td>
<td>2983</td>
<td>2005-04-05</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>The Alliance</td>
<td>8.1</td>
<td>2886</td>
<td>2005-04-12</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>Basketball</td>
<td>8.4</td>
<td>3179</td>
<td>2005-04-19</td>
<td>44</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Our new column can be an operation on other columns</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'rating_div_total_votes'</span>] <span class="op">=</span> df[<span class="st">'imdb_rating'</span>] <span class="op">/</span> df[<span class="st">'total_votes'</span>]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">rating_div_total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>Pilot</td>
<td>7.6</td>
<td>3706</td>
<td>2005-03-24</td>
<td>44</td>
<td>0.002051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>Diversity Day</td>
<td>8.3</td>
<td>3566</td>
<td>2005-03-29</td>
<td>44</td>
<td>0.002328</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>Health Care</td>
<td>7.9</td>
<td>2983</td>
<td>2005-04-05</td>
<td>44</td>
<td>0.002648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>The Alliance</td>
<td>8.1</td>
<td>2886</td>
<td>2005-04-12</td>
<td>44</td>
<td>0.002807</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>Basketball</td>
<td>8.4</td>
<td>3179</td>
<td>2005-04-19</td>
<td>44</td>
<td>0.002642</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>or as simple as adding one to every value.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'y'</span>] <span class="op">=</span> df[<span class="st">'season'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">0</span>:<span class="dv">5</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
<th data-quarto-table-cell-role="th">air_date</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">rating_div_total_votes</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>Pilot</td>
<td>7.6</td>
<td>3706</td>
<td>2005-03-24</td>
<td>44</td>
<td>0.002051</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>Diversity Day</td>
<td>8.3</td>
<td>3566</td>
<td>2005-03-29</td>
<td>44</td>
<td>0.002328</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>Health Care</td>
<td>7.9</td>
<td>2983</td>
<td>2005-04-05</td>
<td>44</td>
<td>0.002648</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>The Alliance</td>
<td>8.1</td>
<td>2886</td>
<td>2005-04-12</td>
<td>44</td>
<td>0.002807</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>Basketball</td>
<td>8.4</td>
<td>3179</td>
<td>2005-04-19</td>
<td>44</td>
<td>0.002642</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span>  df[<span class="st">'season'</span>] <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="writing-data" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="writing-data"><span class="header-section-number">6.8</span> Writing data</h2>
<p>Pandas supports writing out data frames to various formats.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>?df.to_csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you can uncomment the code below to save your dataframe into a csv file. But before doing so, check that your <code>data/output</code> folder is empty, as it would override its content:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'data/output/my_output_ratings.csv'</span>, encoding<span class="op">=</span><span class="st">'UTF-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Likewise, we could export our dataset to an excel file by using <code>to_excel</code>:</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>?df.to_excel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you can uncomment the code below to save your dataframe into an excel file. But before doing so, check that your <code>data/output</code> folder is empty:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_excel('data/output/my_output_ratings.xlsx')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-datasets" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="combining-datasets"><span class="header-section-number">6.9</span> Combining datasets</h2>
<p>In this notebook, our dataset was created from a single file that contained all the data that was needed. However, often times data will be spread into different files that we will need to combine to create our own dataset.</p>
<p>Consider the two dataframes below:</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> pd.read_csv(<span class="st">'data/raw/office1.csv'</span>, encoding<span class="op">=</span><span class="st">'UTF-8'</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>df_2 <span class="op">=</span> pd.read_csv(<span class="st">'data/raw/office2.csv'</span>, encoding<span class="op">=</span><span class="st">'UTF-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5-1</td>
<td>5</td>
<td>1</td>
<td>8.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>9-13</td>
<td>9</td>
<td>13</td>
<td>7.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5-6</td>
<td>5</td>
<td>6</td>
<td>8.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3-23</td>
<td>3</td>
<td>23</td>
<td>9.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9-16</td>
<td>9</td>
<td>16</td>
<td>8.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df_2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4-10</td>
<td>2095</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3-21</td>
<td>2403</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7-24</td>
<td>2040</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6-18</td>
<td>1769</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8-8</td>
<td>1584</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As can be seen, the total votes and imdb ratings data are split between files that we will need to combine. Usually this is done by using a shared column between the two datasets that works as an index. Gladly, <code>head()</code> reveals that in both cases there is a common column called <code>id</code>. We can <em>join</em> the two dataframes together using the common column.</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>inner_join_office_df <span class="op">=</span> pd.merge(df_1, df_2, on<span class="op">=</span><span class="st">'id'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>inner_join_office_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">episode</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
<th data-quarto-table-cell-role="th">total_votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5-1</td>
<td>5</td>
<td>1</td>
<td>8.8</td>
<td>2501</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>9-13</td>
<td>9</td>
<td>13</td>
<td>7.7</td>
<td>1394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5-6</td>
<td>5</td>
<td>6</td>
<td>8.5</td>
<td>2018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3-23</td>
<td>3</td>
<td>23</td>
<td>9.3</td>
<td>3010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9-16</td>
<td>9</td>
<td>16</td>
<td>8.2</td>
<td>1572</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>5-21</td>
<td>5</td>
<td>21</td>
<td>8.7</td>
<td>2032</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>2-13</td>
<td>2</td>
<td>13</td>
<td>8.3</td>
<td>2363</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>9-6</td>
<td>9</td>
<td>6</td>
<td>7.8</td>
<td>1455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>2-2</td>
<td>2</td>
<td>2</td>
<td>8.2</td>
<td>2736</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>3-4</td>
<td>3</td>
<td>4</td>
<td>8.0</td>
<td>2311</td>
</tr>
</tbody>
</table>

<p>188 rows × 5 columns</p>
</div>
</div>
</div>
<p>In this way you can combine datasets using common columns and an <em>inner join</em>. We will leave that for the moment. If you want more information about merging data then see <a href="https://www.datasciencemadesimple.com/join-merge-data-frames-pandas-python/#:~:text=Merge%20%28%29%20Function%20in%20pandas%20is%20similar%20to,rows%20from%20both%20data%20frames%2C%20specify%20how%3D%20%E2%80%98outer%E2%80%99.">this page</a> and the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html">pandas documentation</a>.</p>
<section id="well-done" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="well-done"><span class="header-section-number">6.9.1</span> Well done!</h3>
<p>Well done! You’ve reached the end of a pretty long notebook that went through a lot of details about how to work with this pretty critical package called Pandas. We haven’t really done a lot of detailed analysis in this one yet but we will use Pandas a lot and frequently.</p>
<p>Your best friend will be the Pandas documentation – https://pandas.pydata.org/docs/index.html</p>
<p>This documentation is great. We particuarly recomment the User Guide that will answer most of your questions and will give you a lot of code to copy and paste first and then modify to do what you need to do – https://pandas.pydata.org/docs/user_guide/index.html#user-guide</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/warwickcim\.github\.io\/IM939_handbook\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../content/sessions/session-02.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../content/labs/Lab_2/IM939_Lab_2_2.html" class="pagination-link" aria-label="Lab: Visualising Data">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Lab: Visualising Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://warwick.ac.uk/fac/cross_fac/cim/">Centre for Interdisciplinary Methodologies</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/WarwickCIM/IM939_handbook/blob/main/content/labs/Lab_2/IM939_Lab_2_1.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/WarwickCIM/IM939_handbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/WarwickCIM/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/cimethods">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/cimethods/">
      <i class="bi bi-instagram" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>